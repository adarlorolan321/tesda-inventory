import{m as x,p as n,q as p,s as i,O as v,J as f}from"./app-d32250e8.js";import{l as B,t as d}from"./toastr-4785af89.js";function $(m={},l){const r=x(m),c=n("create"),y=p(()=>f().props.data),t=p(()=>f().props.params),o=n(!1),u=n(null),e=n({perPage:50,query:null,page:1});i(()=>{t.value.page&&(e.value.page=t.value.page),t.value.perPage&&(e.value.perPage=t.value.perPage),t.value.query&&(e.value.query=t.value.query),t.value.sort&&(e.value.sort=t.value.sort),t.value.order&&(e.value.order=t.value.order),t.value.role&&(e.value.role=t.value.role)}),i(()=>{var a=document.getElementById("offCanvasForm");u.value=new bootstrap.Offcanvas(a)});const g=(a,s)=>{(a=="perPage"||a=="query")&&(e.value.page=1),a=="sort"?e.value.sort&&e.value.sort==s?e.value.order=="asc"?(e.value.sort=s,e.value.order="desc"):(e.value.sort=null,e.value.order=null):(e.value.sort=s,e.value.order="asc"):e.value[a]=s,S()},S=B.debounce(()=>{v.get(route(`${l}.index`,e.value),{},{preserveState:!0,preventScroll:!0,only:["data","params"]})},500),h=async()=>{r.clearErrors(),r.post(route(`${l}.store`),{preserveState:!0,preventScroll:!0,only:["data","params","errors"],onSuccess:()=>{d.success("Record saved"),r.reset(),u.value.hide()}})},b=async()=>{r.clearErrors(),r.patch(route(`${l}.update`,r.id),{preserveState:!0,preventScroll:!0,only:["data","params","errors"],onSuccess:()=>{d.success("Record saved"),r.reset(),u.value.hide()}})},P=async a=>{Swal.fire({icon:"warning",title:"Are you sure?",text:"You won't be able to revert this!",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel it!",customClass:{confirmButton:"btn btn-primary me-3",cancelButton:"btn btn-label-danger"}}).then(s=>{s.isConfirmed&&v.delete(route(`${l}.destroy`,a),{preserveState:!0,preventScroll:!0,only:["data","params"],onSuccess:()=>{d.success("Record deleted")}})})},C=()=>{q(),v.reload([]),o.value=!1,setTimeout(()=>{o.value=!0},1e3),c.value="create"},E=a=>{a=JSON.parse(JSON.stringify(a)),r.reset(),r.clearErrors();for(const s in a){const w=a[s];r[s]=w}c.value="update",u.value.show(),o.value=!1,setTimeout(()=>{o.value=!0},1e3)},q=()=>{r.reset(),r.clearErrors()};return{paginatedData:y,isLoadingComponents:o,form:r,createPromise:h,updatePromise:b,deletePromise:P,handleCreate:C,handleEdit:E,serverQuery:e,handleServerQuery:g,formState:c}}export{$ as u};
