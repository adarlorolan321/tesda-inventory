import{s as T,q as v,k as m,p as g,O as f,J as y}from"./app-02325148.js";import{l as $}from"./lodash-eab84a5c.js";import{t as d}from"./toastr-c481c787.js";function R(S={},n,c=null){const t=T(S),i=v("create"),h=m(()=>y().props.data),r=m(()=>y().props.params),l=v(!1),u=v(null),e=v({perPage:50,query:null,page:1});g(()=>{r.value&&(r.value.page&&(e.value.page=r.value.page),r.value.perPage&&(e.value.perPage=r.value.perPage),r.value.query&&(e.value.query=r.value.query),r.value.sort&&(e.value.sort=r.value.sort),r.value.order&&(e.value.order=r.value.order),r.value.role&&(e.value.role=r.value.role),r.value.coach_filter&&(e.value.coach_filter=r.value.coach_filter),r.value.service_filter&&(e.value.service_filter=r.value.service_filter))}),g(()=>{var a=document.getElementById("offCanvasForm");a&&(u.value=new bootstrap.Offcanvas(a))});const p=()=>{u.value&&u.value.hide()},b=()=>{u.value&&u.value.toggle()},C=(a,o)=>{(a=="perPage"||a=="query")&&(e.value.page=1),a=="sort"?e.value.sort&&e.value.sort==o?e.value.order=="asc"?(e.value.sort=o,e.value.order="desc"):(e.value.sort=null,e.value.order=null):(e.value.sort=o,e.value.order="asc"):e.value[a]=o,P()},P=$.debounce(()=>{let a=route(`${n}.index`,e.value);c&&(a=route(c.routeName,{id:c.routeId}));let o={};for(const s in e.value)e.value[s]&&e.value[s]!=""&&(o[s]=e.value[s]);f.get(a,o,{preserveState:!0,preventScroll:!0,only:["data","params"]})},500),O=async()=>{t.clearErrors(),t.post(route(`${n}.store`),{preserveState:!0,preventScroll:!0,only:["data","params","errors"],onSuccess:()=>{d.success("Record saved"),t.reset(),p()}})},E=async()=>{t.clearErrors(),t.patch(route(`${n}.update`,t.id),{preserveState:!0,preventScroll:!0,only:["data","params","errors"],onSuccess:()=>{d.info("Record updated"),t.reset(),p()}})},q=async a=>{console.log(c),Swal.fire({icon:"warning",title:"Are you sure?",text:"You won't be able to revert this!",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel it!",customClass:{confirmButton:"btn btn-primary me-3",cancelButton:"btn btn-label-danger"}}).then(o=>{o.isConfirmed&&f.delete(route(`${n}.destroy`,a),{preserveState:!0,preventScroll:!0,only:["data","params"],onSuccess:()=>{d.error("Record deleted")}})})},w=()=>{_(),f.reload([]),l.value=!1,setTimeout(()=>{l.value=!0},1e3),i.value="create"},B=a=>{a=JSON.parse(JSON.stringify(a)),t.reset(),t.clearErrors();for(const o in a){const s=a[o];t[o]=s}i.value="update",b(),l.value=!1,setTimeout(()=>{l.value=!0},1e3)},_=()=>{t.reset(),t.clearErrors()};return{paginatedData:h,isLoadingComponents:l,form:t,createPromise:O,updatePromise:E,deletePromise:q,handleCreate:w,handleEdit:B,serverQuery:e,handleServerQuery:C,formState:i}}export{R as u};
